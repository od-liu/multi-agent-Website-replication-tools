# 如何正确找出UI差异 - 完整指南

## 核心原则

**⭐ 差异必须从截图的视觉对比中得出，不能从样式查询中臆想！**

## ❌ 错误做法 vs ✅ 正确做法

### 错误做法1：先查样式，后反推差异

```
❌ 错误流程：
1. 读取截图（但没有仔细看）
2. 立即用 browser_evaluate 查询原网站各个元素的样式
3. 发现 header { padding: 20px }，复刻页面是 padding: 15px
4. 报告："差异1：header的padding不一致"

问题：
- 这不是从截图中观察到的视觉差异
- 5px的padding差异可能肉眼根本看不出来
- 这是基于样式值的臆想，不是真实的视觉问题
```

### 正确做法1：先观察截图，后查实现

```
✅ 正确流程：
1. 读取两张截图
2. 仔细观察截图：
   - 看到原网站顶部导航栏的高度明显比复刻页面高
   - 在截图中可以清楚地看出这个视觉差异
3. 报告："差异1：【页面顶部】导航栏高度不一致 - 原网站导航栏看起来更高，
   复刻页面的导航栏明显矮一些，目测差了10-15px左右"
4. 然后调用 browser_evaluate 查询原网站导航栏的准确高度
5. 根据准确数据修复

优点：
- 基于真实的视觉差异
- 肉眼可见的问题
- 修复后用户能明显感知到改进
```

### 错误做法2：没有系统化观察

```
❌ 错误做法：
1. 随机看看截图
2. 凭感觉说几个差异
3. 很多明显的差异遗漏了

结果：
- 第1轮找到2-3个差异
- 后面几轮找不到新的差异
- 实际上还有很多视觉问题没解决
```

### 正确做法2：使用系统化观察方法

```
✅ 正确做法：
使用4层观察法，确保不遗漏：

第1层：页面级
- 整体宽度、高度、背景

第2层：区域级（从上到下）
- 顶部区域
- 中间区域
- 底部区域

第3层：组件级
- 每个主要组件的位置、尺寸、样式

第4层：元素级
- 文字、图标、间距、视觉效果

优点：
- 系统化，不会遗漏
- 每轮都能找到新的差异
- 确保全面覆盖
```

## 🔍 4层系统化观察方法详解

### 第1层：页面级观察（鸟瞰视角）

**目的**：获取整体印象，发现大的结构问题

**观察清单：**
```
□ 页面整体宽度是否一致？
  - 原网站是否占满整个屏幕？复刻页面呢？
  - 是否有明显的宽度差异？

□ 页面整体高度是否一致？
  - 内容是否一样多？
  - 是否有明显的空白或压缩？

□ 背景颜色/图片是否一致？
  - 背景色是否明显不同？
  - 背景图片是否缺失或不同？

□ 整体布局结构是否一致？
  - 是上中下结构还是左右分栏？
  - 布局方式是否一致？
```

**示例差异描述：**
```
✅ 好的描述：
"【页面整体】背景图片不一致 - 原网站截图显示有一张铁路列车的背景图片占据
整个页面，但复刻页面截图中背景是纯白色，完全缺失背景图片"

❌ 不好的描述：
"背景图片不对"（太简单，没有说明在截图中看到了什么）
```

### 第2层：区域级观察（分区检查）

**目的**：分区域细化检查，发现区域级的问题

**观察顺序：从上到下**

#### 2.1 顶部区域

```
□ 顶部导航栏：
  - 高度是否一致？（看起来高矮）
  - 背景色是否一致？（看起来颜色）
  - 位置是否一致？（是否贴顶，是否有间距）

□ Logo：
  - 大小是否一致？（看起来大小）
  - 位置是否一致？（左对齐？居中？）
  - 是否存在？（有没有缺失）

□ 顶部按钮/链接：
  - 数量是否一致？
  - 位置是否一致？（右对齐？间距？）
```

**示例差异描述：**
```
✅ 好的描述：
"【页面顶部左侧】Logo尺寸明显偏小 - 在原网站截图中，Logo宽度占据顶部
导航栏约1/4的宽度，但在复刻页面截图中，Logo只占约1/6的宽度，明显小了很多"
```

#### 2.2 中间区域

```
□ 主要内容区：
  - 宽度是否一致？
  - 居中还是靠左？
  - 间距是否一致？

□ 左右分栏（如有）：
  - 比例是否一致？
  - 是否都存在？
```

#### 2.3 底部区域

```
□ 底部导航/版权信息：
  - 位置是否一致？
  - 对齐方式是否一致？
  - 内容是否完整？
```

### 第3层：组件级观察（聚焦组件）

**目的**：检查每个主要组件的细节

**对于每个组件（如登录框、搜索框、按钮组）：**

```
□ 组件位置：
  - 在父容器中的位置（居中？靠左？靠右？）
  - 与其他元素的距离

□ 组件尺寸：
  - 宽度（占父容器的比例）
  - 高度（看起来高矮）

□ 组件样式：
  - 背景色
  - 边框（有无、粗细、颜色）
  - 圆角（有无、大小）
  - 阴影（有无、明显程度）

□ 内部元素排列：
  - 横向排列还是纵向排列？
  - 元素间距是否一致？
```

**示例差异描述：**
```
✅ 好的描述：
"【页面中部】登录框位置不居中 - 在原网站截图中，登录框在页面水平方向上
完全居中显示，左右留白相等；但在复刻页面截图中，登录框明显偏向左侧，
右侧留白比左侧大得多"
```

### 第4层：元素级观察（细节检查）

**目的**：发现细微的样式差异

#### 4.1 文字

```
□ 字体大小：
  - 看起来是否一样大？
  - 标题和正文的大小对比是否一致？

□ 字体颜色：
  - 颜色是否明显不同？
  - 深浅是否一致？

□ 字体粗细：
  - 看起来是粗体还是正常？
  - 粗细程度是否一致？

□ 行间距/字间距：
  - 文字排列是否紧密？
  - 是否有明显的疏密差异？
```

**示例差异描述：**
```
✅ 好的描述：
"【页面底部】导航文字看起来更细 - 在原网站截图的底部导航栏中，文字看起来
稍微粗一些（可能是medium或semibold），但在复刻页面截图中，相同位置的文字
看起来明显更细，对比很明显"
```

#### 4.2 图标/图片

```
□ 是否存在：
  - 原网站有的图标/图片，复刻页面有没有？

□ 大小：
  - 尺寸是否一致？
  - 与周围元素的比例是否一致？

□ 位置：
  - 位置是否正确？
  - 对齐方式是否一致？

□ 清晰度：
  - 是否模糊或失真？
```

#### 4.3 间距

```
□ 内边距（padding）：
  - 元素内部是否有足够空间？
  - 内容是否贴边？

□ 外边距（margin）：
  - 元素之间的距离是否一致？
  - 是否有明显的空隙差异？

□ 对齐：
  - 元素是否对齐？
  - 是否有错位？
```

**间距观察技巧：**
- 想象在截图上画水平线和垂直线
- 检查元素是否在同一条线上
- 检查元素之间的距离是否相等

#### 4.4 视觉效果

```
□ 阴影：
  - 是否有阴影效果？
  - 阴影是否明显？
  - 阴影的方向和大小是否一致？

□ 圆角：
  - 是否有圆角？
  - 圆角大小是否一致？
  - 是否该有圆角却没有？

□ 边框：
  - 边框粗细是否一致？
  - 边框颜色是否一致？
  - 是否缺失边框？

□ 透明度/渐变：
  - 透明度是否一致？
  - 渐变效果是否存在？
```

## 📐 观察技巧

### 技巧1：对齐线法

在心里（或用工具）在截图上画水平线和垂直线：

```
原网站截图：          复刻页面截图：
│                    │
├─ Logo ────         ├─ Logo ─
│  （对齐左边界）      │  （对齐左边界）
│                    │
│     搜索框 ──       │  搜索框 ─
│    （居中）         │  （偏左！）← 发现差异
│                    │
```

**用途：**
- 检查元素是否对齐
- 检查居中是否正确
- 检查间距是否均匀

### 技巧2：区块法

将页面分成若干区块，逐个对比：

```
┌────────────────────┐
│  区块1：顶部导航栏   │ ← 先对比这个区块
├────────────────────┤
│                    │
│  区块2：主内容区    │ ← 再对比这个区块
│                    │
├────────────────────┤
│  区块3：底部区域    │ ← 最后对比这个区块
└────────────────────┘
```

**用途：**
- 系统化检查，不遗漏
- 每次集中注意力在一个区块

### 技巧3：遮盖法

1. 先看原网站截图的某个区域，仔细记住
2. 再看复刻页面截图的对应区域
3. 对比记忆中的印象和当前看到的

**用途：**
- 发现细微差异
- 训练视觉记忆

### 技巧4：尺寸估算法

目测元素的宽高比例：

```
原网站：Logo宽度 ≈ 导航栏宽度的 1/4
复刻页面：Logo宽度 ≈ 导航栏宽度的 1/6  ← 明显小了
```

**用途：**
- 快速发现尺寸差异
- 不需要精确测量，目测即可

## 📝 差异描述模板

### 好的差异描述应包含：

1. **位置标注**：在截图中的具体位置
2. **差异类型**：颜色/尺寸/位置/布局/缺失等
3. **视觉描述**：在截图中看到的实际不同
4. **对比说明**：原网站是怎样，复刻页面是怎样

### 模板：

```
【位置】差异类型 - 原网站是怎样，复刻页面是怎样，具体差异表现
```

### 5个完整示例：

```
1. 【页面顶部】导航栏背景色不一致 - 在原网站截图中，顶部导航栏是深蓝色
   （接近海军蓝），但在复刻页面截图中，导航栏是浅蓝色（天蓝色），颜色明显
   偏亮，对比非常明显

2. 【页面顶部左侧】Logo尺寸偏小 - 原网站截图的Logo宽度占据顶部导航栏约
   1/4的宽度，高度接近导航栏高度的80%；但复刻页面截图的Logo明显小很多，
   宽度只占约1/6，高度也明显矮一些

3. 【页面中部】登录框没有居中 - 原网站截图中登录框在页面中完全居中，左右
   留白相等；复刻页面截图中登录框明显偏向左侧，目测左侧留白约200px，
   右侧留白约400px，没有居中对齐

4. 【页面右上角】缺少用户头像图标 - 原网站截图的右上角（导航栏内）能看到
   一个圆形的用户头像图标，灰色背景，约30px直径；复刻页面截图的对应位置
   完全是空白的，没有这个图标

5. 【页面底部】版权信息文字更细 - 原网站截图底部的版权信息文字看起来是
   medium粗细，字体有一定的厚重感；复刻页面截图的相同文字明显更细，
   看起来是regular或light，对比很明显
```

## ⚠️ 常见错误和纠正

### 错误1：描述过于简单

```
❌ 错误：
1. 颜色不对
2. 大小不对
3. 位置不对
4. 缺少图片
5. 字体不对

问题：
- 没有说明在截图中的位置
- 没有说明具体是什么不对
- 没有提供对比信息
```

### 错误2：基于样式值，不是视觉观察

```
❌ 错误：
1. 查询发现header的height是80px，复刻页面是70px，所以高度不一致
2. 原网站color是#003A70，复刻页面是#0066CC，颜色不对

问题：
- 这是基于查询的样式值，不是从截图看到的
- 10px的高度差可能肉眼看不出来
- 必须先在截图中看到视觉差异，再去查样式
```

### 错误3：没有位置标注

```
❌ 错误：
1. Logo太小
2. 按钮颜色不对
3. 文字不居中

问题：
- 没有说明在截图的哪个位置
- 无法快速定位问题
- 不够具体
```

### 正确做法：

```
✅ 正确：
1. 【页面顶部左侧】Logo尺寸偏小 - ...
2. 【页面中部登录框】提交按钮背景色不一致 - ...
3. 【页面底部】版权信息文字没有居中 - ...

优点：
- 位置清晰
- 容易定位
- 便于修复
```

## 🎯 实战演练

### 场景：第一轮迭代，找差异

#### 第1步：读取截图

```javascript
read_file("target_page_reference.png")
read_file("replica_page_iteration_1.png")
```

#### 第2步：系统化观察

**页面级观察：**
- ✅ 页面宽度一致
- ❌ 背景图片不一致！（原网站有背景图，复刻页面是纯白）

**区域级观察（顶部）：**
- ❌ 导航栏背景色不一致（原网站深蓝，复刻页面浅蓝）
- ❌ Logo尺寸偏小
- ✅ 导航链接数量一致

**区域级观察（中部）：**
- ❌ 登录框位置偏左，没有居中

**区域级观察（底部）：**
- ❌ 底部导航文字看起来更细

#### 第3步：记录差异（已经找到5处）

```
1. 【页面整体】背景图片缺失 - 原网站截图显示有一张铁路列车的背景图片
   占据整个页面，淡化显示在内容后面；复刻页面截图中背景是纯白色，
   完全缺失这张背景图片

2. 【页面顶部】导航栏背景色不一致 - 原网站截图的顶部导航栏是深蓝色
   （类似#003A70），复刻页面截图的导航栏是浅蓝色（类似#0066CC），
   颜色明显偏亮

3. 【页面顶部左侧】Logo尺寸偏小 - 原网站截图的Logo宽度占据顶部导航栏
   约1/4的宽度，复刻页面截图的Logo只占约1/6的宽度，明显小了很多

4. 【页面中部】登录框没有居中 - 原网站截图中登录框水平居中，复刻页面
   截图中登录框明显偏向左侧，目测偏移约100-150px

5. 【页面底部】导航文字看起来更细 - 原网站截图底部导航文字有一定厚重感，
   复刻页面截图的文字明显更细，对比明显
```

#### 第4步：提供证据

```javascript
checkpoint({
  checkpoint_id: "find_differences",
  iteration_number: 1,
  evidence: "1. 【页面整体】背景图片缺失...\n2. 【页面顶部】导航栏背景色不一致...\n..."
})
```

#### 第5步：查询原网站实现

现在才开始查询样式：

```javascript
browser_evaluate(`
  // 查询导航栏准确的背景色
  const header = document.querySelector('.header');
  return {
    backgroundColor: window.getComputedStyle(header).backgroundColor
  };
`)
// 返回：backgroundColor: "rgb(0, 58, 112)" (#003A70)

// 查询Logo准确尺寸
// ...
```

## 总结

**关键要点：**

1. ⭐⭐⭐ 差异必须从截图视觉对比中得出
2. 使用系统化观察方法（4层观察法）
3. 差异描述要具体，包含位置、类型、对比
4. 查询原网站是为了获取修复数据，不是找差异
5. 禁止先查样式后反推差异

**记住这个顺序：**
```
截图 → 观察 → 差异 → 查询 → 修复
（不是：截图 → 查询 → 反推差异）
```

**每轮迭代都要问自己：**
- ✅ 我有没有仔细看截图？
- ✅ 这些差异是我在截图中看到的吗？
- ✅ 我有没有系统化地检查所有区域？
- ✅ 差异描述够不够具体？

遵循这个指南，你就能准确地找出所有视觉差异！🎯

