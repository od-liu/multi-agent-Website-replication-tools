# UI 调整迭代日志

## Iteration 1
- **差异点**（按优先级：缺失/多余 > 位置尺寸 > 颜色 > 其他；本轮不修改顶部栏/导航栏/底部栏）：
  1. **乘客信息模块标题栏样式不一致** - 中间区域“乘客信息（填写说明）”顶部 - 颜色/高度/排版
  2. **乘客搜索框样式不一致** - 乘客信息标题栏右侧 - 尺寸/边框/图标（目标为小尺寸输入框+20×20图标按钮）
  3. **乘车人列表样式不一致** - 乘客信息模块上半部分 - 复选框排列/间距（目标为朴素复选框，无胶囊背景）
  4. **购票信息表格列宽与控件样式不一致** - 乘客信息模块表格区域 - 列宽/字号/控件高度与背景
  5. **提交按钮区对齐不一致** - 保险横幅下方 - 按钮应更居中、尺寸更贴近目标
  6. **温馨提示框边框与排版不一致** - 中间区域温馨提示 - 边框颜色/圆角/内边距/字号

- **从原站提取的信息（用于对齐）**：
  - 乘客搜索框：wrap=141×20，input=120×20，button=20×20，wrap 边框 `1px solid rgb(18,92,148)`，按钮为背景图标（原站 sprite）。
  - 标题栏：高度约 32px，文字颜色 `rgb(229,248,255)`，字号约 14px。

- **修复内容**：
  - 修改文件：
    - `frontend/src/pages/OrderFillPage.css`
    - `frontend/src/components/OrderFill/TrainInfo.tsx`
    - `frontend/src/components/OrderFill/TrainInfo.css`
    - `frontend/src/components/OrderFill/PassengerInfo.tsx`
    - `frontend/src/components/OrderFill/PassengerInfo.css`
    - `frontend/src/components/OrderFill/SubmitSection.css`
    - `frontend/src/components/OrderFill/WarmTips.css`
  - 修复的差异点：
    - 将主内容区统一为 980px 居中
    - 对齐列车信息/乘客信息标题栏高度、字号、颜色与渐变
    - 将乘客搜索框改为“小输入框+按钮”布局
    - 调整购票信息表格列宽、字号、控件高度与背景
    - 提交按钮区改为居中布局并缩小高度
    - 温馨提示框边框/圆角/内边距/字号对齐

- **验证结果**：待验证（下一步截图对比）
- **剩余问题**：
  - 乘客搜索按钮背景图（原站 sprite）目前使用本地 `icon.png` 近似，后续可进一步下载原站资源以像素级一致。

## Iteration 2
- **差异点**（按优先级：缺失/多余 > 位置尺寸 > 颜色 > 其他；本轮不修改顶部栏/导航栏/底部栏）：
  1. **乘车人列表缺失/不一致** - “乘车人”复选框区域 - 缺失元素（目标为“王三 / 刘嘉敏”，当时页面仅显示“张三”）
  2. **购票信息表格空状态不一致** - “购票信息”表格区域 - 缺失元素（目标图未选乘客时仍有默认第 1 行，之前为空）
  3. **删除按钮缺失（交互态）** - 购票信息第 1 行最右侧 - 缺失元素（选择乘客后应出现橙色圆形×按钮）
  4. **删除按钮多余（空白默认行）** - 购票信息第 1 行最右侧 - 多余元素（未选乘客时右侧应为空，不应出现删除按钮）
  5. **删除按钮背景未渲染** - 购票信息第 1 行最右侧 - 样式差异（按钮存在但图标不显示，需确保 sprite 背景不被覆盖）

- **从目标/原站提取的信息（用于对齐）**：
  - 删除按钮（原站）：`16×16`，使用 sprite `icon.png`，背景定位 `0px -350px`（橙色圆形×）。
  - 为避免全局 `button { background: ... }` 覆盖导致 `background-image` 被清空，使用 `background: url(...) no-repeat ...` 简写并加 `!important`。

- **修复内容**：
  - 修改文件：
    - `frontend/src/components/OrderFill/PassengerInfo.tsx`
    - `frontend/src/components/OrderFill/PassengerInfo.css`
  - 修复的差异点：
    - 乘车人列表：当 API 返回乘客数不足 2 人时，回退到与目标一致的 2 人（王三/刘嘉敏）
    - 购票信息表格：未选乘客时仍渲染默认第 1 行（空姓名/空证件号，席别默认二等座）
    - 删除按钮：
      - 仅在已选乘客行显示（空白默认行不显示）
      - 使用 sprite 图标并改为 `background` 简写，确保图标稳定渲染

- **验证结果**：已修复（截图对比通过）
  - `target_image.png` vs `replica_page_iteration_2.png`：主内容区域结构/控件与目标一致
  - 交互态验证：`replica_page_iteration_2_selected_wangsan.png` 与需求交互截图“订单填写-选择王三.png”一致（右侧删除按钮出现）
- **剩余问题**：无（本轮范围内）

## Iteration 3
- **差异点**（按优先级：缺失/多余 > 位置尺寸 > 颜色 > 其他；本轮不修改顶部栏/导航栏/底部栏）：
  1. **列车信息余票数量不一致** - 页面顶部“列车信息”票价行 - 数值差异（目标：一等座 805张票；当时默认数据为 80张票）
  2. **列车信息余票数量不一致** - 页面顶部“列车信息”票价行 - 数值差异（目标：商务座 105张票；当时默认数据为 10张票）
  3. **票价括号样式不一致** - “列车信息”票价行“一等座” - 其他差异（目标为 `一等座（¥xxxx.x元）`，复刻缺少括号）
  4. **票价括号样式不一致** - “列车信息”票价行“商务座” - 其他差异（目标为 `商务座（¥xxxx.x元）`，复刻缺少括号）
  5. **席别下拉选项文案不一致（与票价括号联动）** - “购票信息”表格“席别”下拉 - 其他差异（票价显示应与上方票价行一致：`（¥xxxx.x元）`）

- **从目标参考图片分析的信息**：
  - 一等座余票：`805张票`；商务座余票：`105张票`
  - 票价文案格式：三档席别均为 `席别（¥xxxx.x元）xxx张票`（均含括号）

- **修复内容**：
  - 修改文件：
    - `frontend/src/pages/OrderFillPage.tsx`
    - `frontend/src/components/OrderFill/TrainInfo.tsx`
  - 修复的差异点：
    - 修正默认列车数据余票数：一等座 `805`、商务座 `105`
    - 对齐票价行括号样式：一等座/商务座补齐 `（` `）`，与二等座一致

- **验证结果**：已修复（截图对比通过）
  - `target_image.png` vs `replica_page_iteration_3_verify.png`：列车信息票价行括号/余票数与目标一致
- **剩余问题**：
  - 无（本轮范围内；顶部栏/导航栏/底部栏按要求未改动）

## Iteration 4
- **差异点**（按优先级：缺失/多余 > 位置尺寸 > 颜色 > 其他；本轮不修改顶部栏/导航栏/底部栏；参考 `requirements/images/order-fill` 截图）：
  1. **列车信息卡片圆角不一致** - 主内容顶部“列车信息”卡片四角 - 视觉效果差异（参考图四角均为圆角；复刻为“仅上圆角”）
  2. **乘客信息卡片圆角不一致** - “乘客信息（填写说明）”卡片四角 - 视觉效果差异（参考图四角均为圆角；复刻为“仅上圆角”）
  3. **购票信息表头底色不一致** - “序号/票种/席别/...”表头行 - 颜色差异（参考图表头为白底；复刻为灰底）
  4. **购票信息表格列宽/整体宽度不一致** - 购票信息表格区域 - 位置尺寸差异（参考图表格基本填满内容区；复刻列宽偏窄、右侧留白明显）
  5. **购票信息数据行底色不一致** - 购票信息第 1 行 - 颜色差异（参考图为淡蓝底；复刻为白底）
  6. **表格控件高度/内边距不一致** - 下拉框与输入框 - 尺寸差异（参考图控件更高、更“厚”；复刻控件偏矮）
  7. **乘车人勾选区与表格之间分隔线缺失** - 乘车人列表下方 - 缺失元素（参考图有明显灰色虚线分隔；复刻缺失）

- **从参考截图分析的信息**：
  - 购票信息表格：表头白底；数据行淡蓝底；控件高度明显大于 24px（更接近 34px）。
  - 分隔线：乘车人列表区域与表格区域之间为一条横向灰色虚线。

- **修复内容**：
  - 修改文件：
    - `frontend/src/components/OrderFill/TrainInfo.css`
    - `frontend/src/components/OrderFill/PassengerInfo.css`
  - 修复的差异点：
    - 列车信息/乘客信息卡片圆角：由“仅上圆角”改为“四角圆角”
    - 购票信息表格：
      - 表头底色改为白色
      - 调整列宽使表格填满内容区（更接近参考图）
      - 数据行改为淡蓝底
      - 下拉框与输入框高度调整到 34px，并微调 padding/radius
    - 增加乘车人区域与表格之间的灰色虚线分隔

- **验证结果**：部分修复（截图对比通过主要差异）
  - 参考：`requirements/images/order-fill/整体页面截图/订单填写页-整体截图.png`
  - 修复前截图：`replica_page_iteration_4.png`
  - 修复后截图：`replica_page_iteration_4_after_patch_2.png`

- **剩余问题**：
  - 仍可微调：表格列宽/表头 padding 与参考图做更细的像素级对齐（当前已接近，但仍可能存在细微差异）。

## Iteration 5（/orders 对齐 `train_order.html`）
- **差异点**（按优先级：缺失/多余 > 位置尺寸 > 颜色 > 其他；本轮不修改顶部栏/导航栏/底部栏/侧边栏）：
  1. **订单卡片缺失** - 订单列表区域 - 缺失元素（目标存在“订票日期/订单号/车票当日当次有效 + 5列表格 + 操作按钮区”）
  2. **Tab 选中态样式不一致** - “未出行订单”Tab - 颜色/下划线/高度（目标高度 42px、蓝色 `rgb(59,153,252)`）
  3. **查询按钮样式不一致** - 筛选区域右侧“查询” - 尺寸/边框/圆角（目标 `100×30`、`1px solid #dedede`、`border-radius: 6px`、白底）
  4. **温馨提示框样式不一致** - 列表底部“温馨提示” - 背景/边框（目标背景 `#fffbf8`、边框 `2px solid #ffddba`、padding `10px 20px`）
  5. **分页区缺失** - 订单卡片下方 - 缺失元素（目标有“共1页 1 到[ ]页 确定”）

- **从原站提取的信息（用于对齐）**：
  - Tab：高度 `42px`，选中文字色 `rgb(59,153,252)`。
  - 查询按钮：`100×30`，`border: 1px solid rgb(222,222,222)`，`border-radius: 6px`，白底。
  - 温馨提示：背景 `rgb(255,251,248)`（`#fffbf8`），边框 `2px solid rgb(255,221,186)`（`#ffddba`），padding `10px 20px`。

- **修复内容**：
  - 修改文件：
    - `frontend/src/components/OrderHistoryPanel/OrderHistoryPanel.tsx`
    - `frontend/src/components/OrderHistoryPanel/OrderHistoryPanel.css`
    - `frontend/src/pages/PersonalInfoPage.tsx`（仅面包屑文案对齐：`当前位置：个人中心>火车票订单`）
  - 修复的差异点：
    - 订单列表改为“订单卡片 + 表格(rowspan)”结构，并支持“两乘车人时第一列共享、第二列起两行”。
    - 对齐 Tab 选中态、筛选行控件高度、查询按钮样式。
    - 对齐温馨提示背景/边框/padding，并补齐分页区。

- **验证结果**：已验证（截图对比通过主要结构与关键样式）
  - 目标：`screenshots/order/target_image.png`
  - 复刻验证：`screenshots/order/replica_page_iteration_1_verify.png`
  - 说明：订单内的具体车次/姓名/价格等内容允许不一致（按本轮要求不做强对齐）。

- **剩余问题**：
  - 日期输入在 macOS 下原生渲染可能显示为 `YYYY/MM/DD`（浏览器实现差异），与目标的 `YYYY-MM-DD` 存在细微差异；目前已确保输入值与布局一致。

## Iteration 6（/orders 第2轮：修复“历史订单查询栏”与“订单项样式”）
- **差异点**（按优先级：缺失/多余 > 位置尺寸 > 颜色 > 其他；本轮不修改顶部栏/导航栏/底部栏/侧边栏）：
  1. **历史订单查询栏布局不一致** - Tab “历史订单”筛选行 - 缺失元素（应与“未出行订单”一致：下拉 + 起止日期 + 搜索框 + 查询按钮）
  2. **历史/未出行默认日期范围不一致** - 筛选行日期 - 内容不一致（应为“过去30天”范围）
  3. **订单项头部样式不一致** - 每个订单卡片顶部蓝色条 - 颜色/排版（缺少复选框样式、圆形展开图标、文字排版不一致）
  4. **订单卡片边框/分割线不一致** - 订单列表区域 - 颜色/线条（目标为淡蓝外框、浅灰表格分割线）
  5. **“订单详情”等按钮区背景色不一致** - 订单卡片底部操作按钮行 - 颜色差异（目标为白底，之前为浅蓝底）

- **修复内容**：
  - 修改文件：
    - `frontend/src/components/OrderHistoryPanel/OrderHistoryPanel.tsx`
    - `frontend/src/components/OrderHistoryPanel/OrderHistoryPanel.css`
  - 修复的差异点：
    - 历史订单筛选行改为与未出行订单一致：`按订票日期查询/按出行日期查询` 下拉 + 日期输入 + 搜索框 + 查询按钮
    - 历史/未出行默认范围统一为“过去30天”
    - 订单卡片头部增加复选框占位与圆形展开图标，并调整背景/边框颜色接近目标
    - 订单卡片外框改为淡蓝边框、表格分割线调整为浅灰
    - “订单详情”等按钮区背景改为白色

- **验证截图**：
  - 目标（未出行）：`screenshots/order/target_upcoming_iteration_2.png`
  - 复刻（未出行）：`screenshots/order/replica_upcoming_iteration_2_after_fix4.png`
  - 目标（历史）：`screenshots/order/target_history_iteration_2.png`
  - 复刻（历史）：`screenshots/order/replica_history_iteration_2_after_fix4.png`
  - 复刻（未完成空态）：`screenshots/order/replica_uncompleted_iteration_2_after_fix3.png`

- **验证结果**：已修复（本轮要求项）
- **剩余问题**：
  - 可继续像素级微调：订单卡片头部字号/间距、表格各列宽度、以及真实站点的复选框/展开图标的 sprite 资源（当前为 CSS 近似绘制）。
  - 订单乘客列已按要求去掉“打印信息单”，仅展示姓名（验证：`screenshots/order/replica_upcoming_iteration_2_after_fix5.png`）。
